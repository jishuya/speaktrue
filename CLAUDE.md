# 1단계: 기획/설계

### 📋 프로젝트 개요 (타겟 & 시나리오 정의)

| 항목 | 내용 |
| --- | --- |
| **프로젝트명** | Usagain (부부싸움 상담 앱) |
| **사용자** | 지수님 + 남편 (각자 개인용) |
| **사용 시점** | 싸운 후 각자 있을 때 |
| **목적** | 감정 정리, 상대방 입장 이해, 대화 순화 → 싸운상태에서 이 앱을켜서 감정을 진정시키고 상대방에서 상처받지 않게 말할 수 있도록 함  |

---

### 🎯 MVP 기능 (우선순위)

| 순위 | 기능 | 설명 |
| --- | --- | --- |
| 1 | 감정 쏟아내기 + 공감/정리 | AI가 공감하며 감정 객관화 |
| 2 | 상대방 입장 전환 | 상대 시점에서 생각해보기 |
| 3 | NVC 변환 | 비폭력대화 스타일로 메시지 순화 |
| 4 | 싸움 패턴 분석 | "이 주제로 자주 싸우시네요" |

**나중에 추가:** 대화 타이밍 제안, TCI 검사 연동

---

### 🛠 기술 스택

`┌─────────────────────────────────────────────┐
│                 클라이언트                     │
│              React Native                   │
│          (Android 우선 배포)                  │
└──────────────────┬──────────────────────────┘
                   │
                   ▼
┌─────────────────────────────────────────────┐
│                  백엔드                      │
│           Node.js + Express                 │
│                   │                         │
│    ┌─────────────┴─────────────┐           │
│    ▼                           ▼           │
│ PostgreSQL              Claude API         │
│ (로컬 PC)               (Sonnet 4.5)       │
└──────────────────┬──────────────────────────┘
                   │
                   ▼
┌─────────────────────────────────────────────┐
│                  배포                        │
│     로컬 PC + Cloudflare Tunnel             │
└─────────────────────────────────────────────┘`

| 영역 | 기술 |
| --- | --- |
| 프론트엔드 | React Native |
| 백엔드 | Node.js + Express |
| 데이터베이스 | PostgreSQL (로컬) |
| 인증 | 카카오 / 네이버 / 구글 OAuth |
| AI | Claude API (Sonnet 4.5) |
| 배포 | 로컬 PC + Cloudflare Tunnel |
| 앱 배포 | Android (APK) |

---

### 📱 화면 설계 (5개)

`[홈] → [감정토로 채팅] → [NVC 변환] 
                ↓
           [히스토리] ← [설정]`

| 화면 | 기능 |
| --- | --- |
| 홈 | 시작 버튼, 최근 기록 |
| 감정 토로 | AI 채팅 (공감/정리/입장전환) |
| NVC 변환 | 메시지 입력 → 순화 → 복사 |
| 히스토리 | 과거 대화, 패턴 통계 |
| 설정 | 프로필, 로그아웃 |

---

### 🎨 UI/UX 방향

- 차분한 색상 (연한 파랑/초록/베이지)
- 심플하게, 여백 넉넉히
- 버튼/글자 크게

---

### 💰 예상 비용

| 항목 | 비용 |
| --- | --- |
| Claude API | $5 무료 크레딧 (수개월 사용 가능) |
| Cloudflare Tunnel | 무료 |
| PostgreSQL | 로컬이라 무료 |
| **총** | **거의 $0** |

### 🔩시스템 아키텍처

### 전체 구조

`┌─────────────────────────────────────────────────────────────┐
│                    React Native App                         │
└──────────────────────────┬──────────────────────────────────┘
                           │
                           ▼
                  ┌─────────────────┐
                  │ Cloudflare Tunnel│
                  └────────┬────────┘
                           │
                           ▼
┌──────────────────────────────────────────────────────────────┐
│                   Express Server                             │
│                                                              │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐    │
│  │  Auth    │  │   Chat   │  │   NVC    │  │ History  │    │
│  │ Routes   │  │  Routes  │  │  Routes  │  │  Routes  │    │
│  └────┬─────┘  └────┬─────┘  └────┬─────┘  └────┬─────┘    │
│       │             │             │             │           │
│       ▼             ▼             ▼             ▼           │
│  ┌─────────────────────────────────────────────────────┐   │
│  │                   Services                           │   │
│  │  ┌───────────┐  ┌───────────┐  ┌───────────┐       │   │
│  │  │ OAuth     │  │ Claude AI │  │ Analysis  │       │   │
│  │  │ Service   │  │ Service   │  │ Service   │       │   │
│  │  └───────────┘  └───────────┘  └───────────┘       │   │
│  └─────────────────────────────────────────────────────┘   │
│                            │                                │
└────────────────────────────┼────────────────────────────────┘
                             │
              ┌──────────────┴──────────────┐
              ▼                              ▼
      ┌──────────────┐              ┌──────────────┐
      │  PostgreSQL  │              │  Claude API  │
      │   (로컬 PC)   │              │  (Sonnet)    │
      └──────────────┘              └──────────────┘`

---

### API 엔드포인트 목록

### 1. 인증 (Auth)

| Method | Endpoint | 설명 |
| --- | --- | --- |
| POST | `/auth/kakao` | 카카오 로그인 |
| POST | `/auth/naver` | 네이버 로그인 |
| POST | `/auth/google` | 구글 로그인 |
| POST | `/auth/logout` | 로그아웃 |
| GET | `/auth/me` | 내 정보 조회 |
| DELETE | `/auth/withdraw` | 회원 탈퇴 |

### 2. 채팅 (Chat) - 감정토로 & 입장전환

| Method | Endpoint | 설명 |
| --- | --- | --- |
| POST | `/chat/session` | 새 상담 세션 시작 |
| POST | `/chat/message` | 메시지 전송 → AI 응답 |
| GET | `/chat/session/:id` | 특정 세션 대화 조회 |
| PATCH | `/chat/session/:id/end` | 세션 종료 |

### 3. NVC 변환

| Method | Endpoint | 설명 |
| --- | --- | --- |
| POST | `/nvc/convert` | 메시지 → NVC 변환 |

### 4. 히스토리 & 분석

| Method | Endpoint | 설명 |
| --- | --- | --- |
| GET | `/history/sessions` | 내 세션 목록 |
| GET | `/history/sessions/:id` | 세션 상세 |
| DELETE | `/history/sessions/:id` | 세션 삭제 |
| GET | `/analysis/patterns` | 싸움 패턴 분석 |
| GET | `/analysis/topics` | 주제별 통계 |

### 5. 사용자 설정

| Method | Endpoint | 설명 |
| --- | --- | --- |
| GET | `/user/profile` | 프로필 조회 |
| PATCH | `/user/profile` | 프로필 수정 |

# 2단계: 환경 세팅

- React Native 프로젝트 생성
- PostgreSQL 세팅
- Express 서버 초기화
- 폴더 구조 잡기
- Claude API 연동 테스트

---

# 3단계: 백엔드 개발

- OAuth 인증 (카카오/네이버/구글)
- API 엔드포인트 구현
- Claude API 연동
- DB CRUD

---

# 4단계: 프론트엔드 개발

- 화면별 UI 구현 (5개 화면)
- API 연동
- 채팅 인터페이스
- NVC 변환 화면

---

# 5단계: AI 프롬프트 튜닝

- 공감/정리 프롬프트
- 입장 전환 프롬프트
- NVC 변환 프롬프트
- 테스트 & 개선

---

# 6단계: 테스트 & 배포

- 실사용 테스트 (지수님 + 남편)
- 버그 수정
- Cloudflare Tunnel 연결
- Android APK 배포